/*
 *  jQuery backgroundcover - v1.0.0
 *  jQuery plugin to make CSS3 'background-size: cover' even smarter.
 *  https://github.com/kaliber5/jquery-backgroundcove
 *
 *  Made by Simon Ihmig
 *  Under MIT License
 */
!function(a,b){function c(b,c){this.$element=a(b),this.settings=a.extend({},e,this.$element.data(),c),this._defaults=e,this._name=d,this.init()}var d="backgroundcover",e={image:null,safearea:"0%,0%,100%,100%"};c.prototype={init:function(){function c(a){h.imageWidth=a.width,h.imageHeight=a.height,h.loaded=!0,h.setSafearea(h.settings.safearea)}var d,e,f,g,h=this;if(this.image=this.settings.image,!this.image){if(d=this.$element.css("background-image"),!d)throw new Error("No background image available");if(e=d.match(/url\([\"\']?([^\"\']*)[\"\']?\)/i),!e)throw new Error("Background image could not be retrieved from CSS property");this.image=e[1]}"undefined"==typeof this.$element.css("background-size")?(this.mode="img",this.$img=a('<img src="'+this.image+'" />').css("position","absolute"),"static"===this.$element.css("position")&&this.$element.css("position","relative"),this.$element.css("background-image","none").css("overflow","hidden").prepend(this.$img)):(this.mode="css",this.$element.css("background-image","url("+this.image+")")),this.loaded=!1,f=new Image,f.onload=function(){c(this)},g=this.image,navigator.userAgent.match(/msie/i)&&(g+="?"+(new Date).valueOf()),f.src=g,f.complete&&c(f),a(b).resize(function(){h.layout()})},setSafearea:function(a){if(this.settings.safearea=a,this.loaded){var b=a.split(","),c=function(a,b){if("number"==typeof a)return a;if("function"==typeof a.trim&&(a=a.trim()),"%"===a.charAt(a.length-1)){var c=parseFloat(a);return Math.round(c/100*b)}return Math.round(parseFloat(a))};this.safearea={x1:c(b[0],this.imageWidth),y1:c(b[1],this.imageHeight),x2:c(b[2],this.imageWidth),y2:c(b[3],this.imageHeight)},this.layout()}},layout:function(){if(this.loaded){var a,b,c,d,e,f,g,h,i,j=this.$element.width(),k=this.$element.height(),l=j/k,m=this.safearea.x1,n=this.safearea.y1,o=this.safearea.x2,p=this.safearea.y2,q=o-m,r=p-n,s=this.imageWidth,t=this.imageHeight,u=s/t,v=q/s,w=r/t;l>u?(a=j,b=Math.round(a/u),i=a/s,r*i>k&&(b=Math.round(k/w),a=Math.round(b*u),i=a/s)):(b=k,a=Math.round(b*u),i=a/s,q*i>j&&(a=Math.round(j/v),b=Math.round(a/u),i=a/s)),d=(b-k)/2,c=(a-j)/2,f=n*i-d,h=b-p*i-d,0>f?d+=f:0>h&&(d-=h),e=m*i-c,g=a-o*i-c,0>e?c+=e:0>g&&(c-=g),c=Math.round(-c),d=Math.round(-d),this._update(a,b,c,d)}},_update:function(a,b,c,d){"css"===this.mode?this.$element.css("background-position",c+"px "+d+"px").css("background-size",a+"px "+b+"px"):"img"===this.mode&&this.$img.css("width",a+"px").css("height",b+"px").css("top",d+"px").css("left",c+"px")}},a.fn[d]=function(b){return this.each(function(){a.data(this,d)||a.data(this,d,new c(this,b))})}}(jQuery,window,document);